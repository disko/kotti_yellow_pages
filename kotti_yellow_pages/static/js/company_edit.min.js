var CompanyEditCtrl;CompanyEditCtrl=function(b,e,c,d){var a;b.location=new L.LatLng(0,0);b.map=d;b.map.setView(b.location,6);b.marker=L.marker(b.location,{draggable:true}).addTo(b.map);b.locateAddress=function(){c.info("Updating location from scope.address...");if(!b.addressSubform.$valid){return false}d.latLngForAddress(b.company.address).then(function(g){var h,f;if(g.length!==1){c.warn("response.data contains "+g.length+" results.");return false}f=g[0].locations;if(f.length<1){c.warn("results[0] contains "+f.length+" locations.");return false}h=f[0].latLng;h=new L.LatLng(h.lat,h.lng);b.company.location.lat=latLng.lat;b.company.location.lng=latLng.lng;return b.setMarkerFromLocation()});return false};b.setMarkerFromLocation=function(){c.info("Updating marker position and form field values from scope.location...");b.marker.setLatLng(b.company.location);b.map.panTo(b.company.location);b.map.setZoom(14);return false};b.marker.on("dragend",function(f){return b.$apply(function(){b.company.location.lat=f.target._latlng.lat;return b.company.location.lng=f.target._latlng.lng})});a=function(){var f;c.info("handleLocationChange");f=b.company.location;if(!(f&&f.lat&&f.lng)){return false}if(!L.LatLng.isPrototypeOf(b.company.location)){b.company.location=new L.LatLng(f.lat,f.lng)}return b.setMarkerFromLocation()};b.$watch("company.location.lat",a,false);return b.$watch("company.location.lng",a,false)};